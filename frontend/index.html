<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TDucShop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/reset.css" />
    <link rel="stylesheet" href="assets/css/grid.css" />
    <link rel="stylesheet" href="assets/css/header.css" />
    <link rel="stylesheet" href="assets/css/homepage.css" />
    <link rel="stylesheet" href="assets/css/login.css" />
    <link rel="stylesheet" href="assets/css/footer.css" />
    <script
      src="https://kit.fontawesome.com/8373f8f77a.js"
      crossorigin="anonymous"
    ></script>
    <script src="/js/config.js"></script>
  </head>
  <body>
    <header>
      <nav>
        <a href="index.html" class="logo-shop"
          ><span class="logo-text">TDucShop</span></a
        >
        <ul>
          <li>
            <a href="#" class="mode">
              <i class="fa-solid fa-list-ul" style="color: #ffffff"></i>
              <span>Danh mục</span>
            </a>
          </li>
          <li>
            <a href="#" class="mode">
              <i class="fa-solid fa-location-dot" style="color: #ffffff"></i>
              <span>Cửa hàng gần bạn</span>
            </a>
          </li>
          <li>
            <div class="search-box">
              <input type="search" id="searchInput" placeholder="Tìm kiếm..." />
              <button type="submit" id="searchBtn" aria-label="Tìm kiếm">
                <i class="fa-solid fa-magnifying-glass"></i>
              </button>
            </div>
          </li>
          <li>
            <a
              href="tel:0123456789"
              class="mode"
              title="Số điện thoại: 0123456789"
            >
              <i class="fa-solid fa-phone" style="color: #ffffff"></i>
              <span>Gọi hỗ trợ</span>
            </a>
          </li>
          <li>
            <a href="customerOrders.html" class="mode">
              <i class="fa-solid fa-truck-fast" style="color: #ffffff"></i>
              <span>Tra cứu đơn hàng</span>
            </a>
          </li>
          <li>
            <a href="cart.html" class="mode">
              <i class="fa-solid fa-cart-shopping" style="color: #ffffff"></i>
              <span>Giỏ hàng</span>
            </a>
          </li>
          <li id="login-click">
            <a href="#" class="mode">
              <i class="fa-solid fa-user" style="color: #ffffff"></i>
              <span>Đăng nhập</span>
            </a>
          </li>
        </ul>
      </nav>
    </header>

    <main>
      <div class="banner">
        <img src="assets/img/ad1.jpg" class="slide" alt="Quảng cáo 1" />
        <!-- <img src="assets/img/ad2.jpg" class="slide" alt="Quảng cáo 2" />
          <img src="assets/img/ad3.jpg" class="slide" alt="Quảng cáo 3" />
          <img src="assets/img/ad4.jpg" class="slide" alt="Quảng cáo 3" /> -->
      </div>

      <div class="content">
        <div class="nav-extra">
          <span class="text">Các dòng máy phổ biến</span>
          <ul class="list">
            <li><a href="#iphone">Apple</a></li>
            <li><a href="#samsung">Samsung</a></li>
            <li><a href="#xiaomi">Xiaomi</a></li>
            <li><a href="#oppo">OPPO</a></li>
            <li><a href="storange.html">Khác...</a></li>
          </ul>
        </div>

        <div class="container">
          <div class="category">
            <span id="iphone" class="brand">Apple</span>
            <section class="products grid apple-products">
              <div class="row apple-row"></div>
            </section>
          </div>

          <div class="category">
            <span id="samsung" class="brand">Samsung</span>
            <section class="products grid samsung-products">
              <div class="row samsung-row"></div>
            </section>
          </div>

          <div class="category">
            <span id="xiaomi" class="brand">Xiaomi</span>
            <section class="products grid xiaomi-products">
              <div class="row xiaomi-row"></div>
            </section>
          </div>

          <div class="category">
            <span id="oppo" class="brand">OPPO</span>
            <section class="products grid oppo-products">
              <div class="row oppo-row"></div>
            </section>
          </div>
        </div>
        <div class="more-product">
          <a href="storange.html"
            >Xem thêm
            <i class="fa-solid fa-angle-down fa-xs" style="color: #000000"></i
          ></a>
        </div>
      </div>
      <form id="login">
        <div class="login-form">
          <h2>Đăng nhập</h2>
          <label for="username">Email: </label>
          <input
            type="email"
            name=""
            id="username"
            autocomplete="current-password"
          />

          <label for="password">Mật khẩu: </label>
          <input
            type="password"
            name=""
            id="password"
            autocomplete="current-password"
          />

          <label for="rewrite" class="register">Xác nhận mật khẩu: </label>
          <input type="text" class="register" name="" id="rewrite" />

          <div class="help">
            <span id="register-btn">Đăng ký</span>
            <span>Quên mật khẩu?</span>
          </div>

          <button type="submit" id="login-btn" class="login-btn">
            Đăng nhập
          </button>
          <button type="submit" class="register">Đăng ký</button>
        </div>
      </form>
    </main>

    <footer>
      <div class="footer-container">
        <div class="part">
          <h2 class="part-name">Thông tin chính sách</h2>
          <a href="guarantee.html"><p>Chính sách bảo hành</p></a>
          <a href="delivery.html"><p>Chính sách giao hàng</p></a>
        </div>
        <div class="part">
          <h2 class="part-name">Tổng đài hỗ trợ miễn phí</h2>
          <a href="tel:0123456789"
            ><p>Gọi mua hàng <strong>0123456789</strong> (7h30 - 21h30)</p></a
          >
          <a href="tel:0123456789#"
            ><p>Gọi khiếu nại <strong>0123456789</strong> (8h - 21h)</p></a
          >
          <a href="tel:0123456789#"
            ><p>Gọi bảo hành <strong>0123456789</strong> (8h - 20h)</p></a
          >
        </div>
        <div class="part">
          <h2 class="part-name">Kết nối với chúng tôi</h2>
          <a
            target="_blank"
            href="https://www.youtube.com/results?search_query=h%E1%BB%8Dc+vi%E1%BB%87n+c%C3%B4ng+ngh%E1%BB%87+b%C6%B0u+ch%C3%ADnh+vi%E1%BB%85n+th%C3%B4ng"
            ><i class="fa-brands fa-youtube" style="color: #ff0000"></i
          ></a>
          <a target="_blank" href="https://www.facebook.com/HocvienPTIT"
            ><i class="fa-brands fa-facebook" style="color: #0865ff"></i
          ></a>
          <a
            target="_blank"
            href="https://www.tiktok.com/search?q=hoc%20vien%20cong%20nghe%20buu%20chinh%20vien%20thong&t=1740815527204"
            ><i class="fa-brands fa-tiktok"></i
          ></a>
          <a target="_blank" href="https://x.com/"
            ><i class="fa-brands fa-square-x-twitter" style="color: #000000"></i
          ></a>
        </div>
        <div class="part">
          <h2 class="part-name">Phương thức thanh toán</h2>
          <img src="assets/img/payment.png" alt="" />
        </div>
      </div>
    </footer>
    <script src="assets/javascript/login.js"></script>
    <script src="/js/fetchProducts.js"></script>
    <script src="assets/javascript/search.js"></script>
    <script>
      window.onload = function () {
        updateLoginButton();
        fetchProducts({ page: 1 })
          .then((response) => {
            console.log("Danh sách sản phẩm:", response);
            if (response && Array.isArray(response)) {
              // Lọc sản phẩm theo category_id
              const appleProducts = response
                .filter((p) => p.category_id === 1)
                .slice(0, 5);
              const samsungProducts = response
                .filter((p) => p.category_id === 2)
                .slice(0, 5);
              const xiaomiProducts = response
                .filter((p) => p.category_id === 3)
                .slice(0, 5);
              const oppoProducts = response
                .filter((p) => p.category_id === 4)
                .slice(0, 5);

              // Gọi hàm hiển thị cho từng loại
              renderProducts(".apple-row", appleProducts);
              renderProducts(".samsung-row", samsungProducts);
              renderProducts(".xiaomi-row", xiaomiProducts);
              renderProducts(".oppo-row", oppoProducts);
            } else {
              console.error("Dữ liệu không hợp lệ:", response);
              document.querySelector(".product-list .row").innerHTML =
                "<p>Không thể tải danh sách sản phẩm.</p>";
            }
          })
          .catch((error) => {
            console.error("Lỗi khi tải sản phẩm:", error);
            const productList = document.querySelector(".product-list .row");
            if (productList) {
              productList.innerHTML = "<p>Đã xảy ra lỗi khi tải sản phẩm.</p>";
            }
          });
      };

      // Hàm hiển thị sản phẩm
      function renderProducts(selector, products) {
        document.querySelector(selector).innerHTML = products
          .map(
            (product) => `
    <div class="col l-2-4">
      <a class="item" data-id="${product.id}">
        <img src="/img/${product.image_url || "default.png"}" alt="${
              product.name
            }" />

        <div class="product-info">
          <span class="product-name">${product.name}</span>
          <div class="feature">
            <span class="product-feature">${
              product.screen_size || "N/A"
            } inches</span>
            <span class="product-feature">${product.ROM || "N/A"} GB</span>
          </div>
          <div class="price">
            <div class="price-current">${Number(product.price).toLocaleString(
              "vi-VN"
            )}đ</div>
            <div class="price-old">${Number(product.price_old).toLocaleString(
              "vi-VN"
            )}đ</div>
          </div>
        </div>
      </a>
    </div>
  `
          )
          .join("");
      }
    </script>
    <!-- Xem thêm -->
    <script>
      document.addEventListener("click", function (e) {
        const item = e.target.closest(".item[data-id]");
        if (item) {
          const productId = item.getAttribute("data-id");
          window.location.href = `product.html?id=${productId}`;
        }
      });
    </script>
  </body>
</html>
